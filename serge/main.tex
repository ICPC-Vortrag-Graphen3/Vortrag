\pgfdeclarelayer{bg}
\pgfsetlayers{bg,main}
\setbeamercovered{invisible}


\tikzstyle{source}=[circle, fill=red!25]
\tikzstyle{target} = [circle, fill=blue!25]
\tikzstyle{otherCollector} = [circle, fill=green!25]
\tikzstyle{card} = [circle, fill=black!25]
\tikzstyle{edge} = [->,thick]


\section{UVa 10779 - Collector's Problem}
\subsection{Aufgabenstellung}
    \begin{frame}{UVa 10779 - Collector's Problem}
        \begin{block}{UVa 10779 - Collector's Problem}
            \begin{itemize}
                \item Unterschiedliche Karten zum Sammeln
                \pause\item Alle Karten sind gleich viel Wert, Tausch 1 zu 1
                \pause\item Andere Sammler tauschen nur eigene Duplikate gegen Karten,
                die sie noch nicht besitzen
                \pause\item Bob tauscht beliebig (auch Einzelstücke ein und gegen
                Karten, die er bereits besitzt)
                \pause\item Wie viele unterschiedliche Karten kann Bob maximal besitzen?
            \end{itemize}
        \end{block}
    \end{frame}

\subsection{Lösung}

\begin{frame}{Ohne in Doppelte eintauschen}
    \begin{figure}
        \begin{tikzpicture}[scale=0.7]
            \node[source, visible on=<{1-4, 8-}>] (BobS) at (0,0) {BobS};
            \node[target, visible on=<{1-4, 8-}>] (BobT) at (13,0) {BobT};
            \foreach \i in {1,...,5} {
                \node[card, visible on=<{2-4, 8-}>] (BobWantsType_\i) at (10, {2*(\i-3)}) {$\i_{w}$};
                \draw[edge, visible on=<{2-4, 8-}>] (BobWantsType_\i) -- (BobT) node [midway, above, sloped]
                (wantToBob_\i) {$1$};
            }
            \foreach \i/\amount in {{1/2}, {3/1}, {4/2}, {5/3}}
            {
                \node[card, visible on=<{3-4, 8-}>] (BobHasType_\i) at (3, {2*(\i-3)}) {$\i_{h}$};
                \draw [edge, visible on=<{3-4, 8-}>] (BobS) -- (BobHasType_\i) node [midway, above, sloped]
                (amount_\i) {$\amount$};
                \draw [edge, visible on=<{4, 8-}>] (BobHasType_\i) -- (BobWantsType_\i) node [midway, above, sloped]
                (hasToWant_\i) {$1$};
            }
            \node[otherCollector, visible on=<{5-}>] (A) at (6.5,-2) {A};
            \foreach \i in {1,4}
            {
                \node[card, visible on=<{6-7}>] (AWantsType_\i) at (3, {2*(\i-3)}) {$\i$};
                \draw [edge, visible on=<{6-7}>] (AWantsType_\i) -- (A) node [midway, above, sloped]
                (asWantToA_\i) {$1$};
                \draw [edge, visible on=<{8-}>] (BobHasType_\i) -- (A) node [midway, above, sloped]
                (bobHasToA_\i) {$1$};
            }
            \foreach \i/\amount in {{2/3}}
            {
                \node[card, visible on=<{7}>] (AHasType_\i) at (10, {2*(\i-3)}) {$\i$};
                \draw [edge, visible on=<{7}>] (A) -- (AHasType_\i) node [midway, above, sloped]
                (asToHas_\i) {$\amount$};
                \draw [edge, visible on=<{8-}>] (A) -- (BobWantsType_\i) node [midway, above, sloped]
                (asToBobWants_\i) {$\amount$};
            }

        \end{tikzpicture}
    \end{figure}
\end{frame}

\begin{frame}{Mit in Doppelte eintauschen}
    \begin{figure}
        \begin{tikzpicture}[scale=0.7]
            \node[source, visible on=<{1-}>] (BobS) at (0,0) {BobS};
            \node[target, visible on=<{1-}>] (BobT) at (13,0) {BobT};
            \foreach \i in {1,...,5} {
                \node[card, visible on=<{1-}>] (BobWantsType_\i) at (10, {2*(\i-3)}) {$\i_{w}$};
                \draw[edge, visible on=<{1-}>] (BobWantsType_\i) -- (BobT) node [midway, above, sloped]
                (wantToBob_\i) {$1$};
            }
            \foreach \i/\amount in {{1/2}, {2/0}, {3/1}, {4/2}, {5/3}}
            {
                \node[card, visible on=<{1-}>] (BobHasType_\i) at (3, {2*(\i-3)}) {$\i_{h}$};
                \draw [edge, visible on=<{1-}>] (BobS) -- (BobHasType_\i) node [midway, above, sloped]
                (amount_\i) {$\amount$};
                \draw [edge, visible on=<{1-}>] (BobHasType_\i) -- (BobWantsType_\i) node [midway, above, sloped]
                (hasToWant_\i) {$1$};
            }
            \begin{pgfonlayer}{bg}
                \node[circle, fill=red!25, text=red!25, visible on=<{1}>] at (amount_2) {0};
            \end{pgfonlayer}
            \node[otherCollector, visible on=<{2-}>] (A) at (6.5,-1) {A};
            \foreach \i in {1,4}
            {
                \draw [edge, visible on=<{2-}>] (BobHasType_\i) -- (A) node [midway, above, sloped]
                (bobHasToA_\i) {$1$};
            }
            \foreach \i/\amount in {{2/3}}
            {
                \draw [edge, visible on=<{2-}>] (A) -- (BobHasType_\i) node [midway, above, sloped]
                (asToBobWants_\i) {$\amount$};
            }

            \begin{pgfonlayer}{bg}
            \foreach \source/\dest in {{BobS/BobHasType_4}, {BobHasType_4/A}, {A/BobHasType_2}, {BobHasType_2/BobWantsType_2}, {BobWantsType_2/BobT}}
                \draw[-, red!50, line width=5pt, visible on=<3->] (\source) -- (\dest);
            \end{pgfonlayer}
        \end{tikzpicture}
    \end{figure}
\end{frame}

\begin{frame}{Beispiel}
    \begin{figure}
        \begin{tikzpicture}[scale=0.7]
            \node[source, visible on=<{1-}>] (BobS) at (0,-3) {BobS};
            \node[target, visible on=<{1-}>] (BobT) at (0,3) {BobT};
            \foreach \i/\amount in {{1/1}, {2/0}, {3/0}, {4/2}, {5/3}}
            {
                \node[card, visible on=<{1-}>] (Type_\i) at (5, {2*(\i-3)}) {$\i_{h}$};
                \draw [edge, visible on=<{1-}>] (BobS) -- (Type_\i) node [pos=0.3, above, sloped]
                (amount_\i) {$\amount$};
                \draw [edge, visible on=<{1-}>] (Type_\i) -- (BobT) node [pos=0.3,
                above, sloped] {$1$};
            }

            \node[otherCollector, visible on=<{2-}>] (A) at (9,-3) {A};
            \foreach \i in {1}
            {
                \draw [edge, visible on=<{2-}>] (Type_\i) -- (A) node [midway, above, sloped]
                (bobHasToA_\i) {$1$};
            }
            \foreach \i/\amount in {{2/3}}
            {
                \draw [edge, visible on=<{2-}>] (A) -- (Type_\i) node [midway, above, sloped]
                (aToBobWants_\i) {$\amount$};
            }

            \node[otherCollector, visible on=<{3-}>] (B) at (9,1) {B};
            \foreach \i in {5}
            {
                \draw [edge, visible on=<{3-}>] (Type_\i) -- (B) node [midway, above, sloped]
                (bobHasToB_\i) {$1$};
            }
            \foreach \i/\amount in {{1/2}, {3/1}}
            {
                \draw [edge, visible on=<{3-}>] (B) -- (Type_\i) node [midway, above, sloped]
                (bToBobWants_\i) {$\amount$};
            }

            \begin{pgfonlayer}{bg}
            \foreach \source/\dest in {{BobS/Type_5}, {Type_5/B}, {B/Type_3}, {Type_3/Type_3}, {Type_3/BobT}}
                \draw[-, red!50, line width=5pt, visible on=<4>] (\source) --
                (\dest);
            \foreach \source/\dest in {{BobS/Type_5}, {Type_5/B}, {B/Type_1}, {Type_1/A}, {A/Type_2}, {Type_2/Type_2}, {Type_2/BobT}}
                \draw[-, red!50, line width=5pt, visible on=<5>] (\source) -- (\dest);

            \end{pgfonlayer}
        \end{tikzpicture}
    \end{figure}
\end{frame}

\section{Variationen von Network Flow}
\subsection{Multi-source \& Multi-sink}
\begin{frame}{Multi-source \& Multi-sink}
    \begin{itemize}
        \pause\item Situation: Mehrere sources $s_0,\dots,s_i$ und sinks $t_0,\dots,t_j$
        \pause\item Füge zwei neue Knoten hinzu, eine super source $ss$ und ein super sink $st$
        \pause\item \(\forall \mathbb{N}_0 \ni x \leq i : \text{Füge } (ss, s_x) \text{ mit
        Gewicht $\infty$ zu $E$ hinzu}\)
        \item \(\forall \mathbb{N}_0 \ni y \leq j : \text{Füge } (t_y, st) \text{ mit
        Gewicht $\infty$ zu $E$ hinzu}\)
        \pause\item Berechne Max-Flow von $ss$ nach $st$
    \end{itemize}
\end{frame}

\subsection{Knoten Kapazität}
\begin{frame}{Knoten Kapazität}
    \begin{itemize}
        \pause\item Situation: Knoten $v_0,\dots,v_i$ haben eigene Kapazität
        \pause\item Ersetze jeden Knoten $v_x$ durch zwei Knoten $v\_in_x$ und $v\_out_x$ und verbinde sie durch eine gerichtete Kante mit der Knotenkapazität als Gewicht
		\begin{itemize}        
        \pause\item \(V' \defas \set{v\_in_0, v\_out_0, \dots, v\_in_i, v\_out_i}\)
        \pause\item \(E' \defas E \cup \set{(v\_in_x, v\_out_x) : \mathbb{N}_0 \ni x \leq i}\)
        \pause\item \(\forall \mathbb{N}_0 \ni x \leq i : w((v\_in_x, v\_out_x)) \defas w(v_x)\)
        \end{itemize}
        \pause\item Doppelte Anzahl an Knoten!
    \end{itemize}
\end{frame}

\subsection{Min Cut}
\begin{frame}{Schnitt}
    \begin{block}{Definition}
        \pause Ist \(V = S \dot{\cup} T\) eine Partition von \(V\) mit \(s \in S, \ t \in T\), so heißt \(C := (S, T)\) ein \textbf{$s$-$t$ cut} (oder \textbf{$s$-$t$ Schnitt}).\\\pause
        Das zu $C$ gehörige \textbf{cut-set} ist
        \[X_C \defas \set{(u, v) \in E \given u \in S, v \in T} = (S\times
        T)\cap E\]
%        und dass $s$ und $t$ mit der Kantenmenge
%        \(E' \defas E\setminus X_C\) getrennt wären \pause bzw. der Max %Flow null ist.\\
        \pause
        Die \textbf{Kosten} des Schnittes sind definiert durch
        \(c(S, T) \defas \sum\nolimits_{(u, v) \in X_C} c(u, v)\)
    \end{block}
\end{frame}

\begin{frame}{Min Cut}
    \begin{block}{Definition}
        \pause Ein \textbf{Min Cut} ist ein $s$-$t$ cut \(C = (S, T)\) mit minimalen Kosten.\\\pause
        Für einen solchen gilt insbesondere:
        \[\forall e \in X_C, X_C' \defas X_C \setminus e :
        \text{ Es existiert ein Weg von $s$ nach $t$ in } (V, E \setminus X_C')\]
    \end{block}
\end{frame}

\begin{frame}{Berechnung Min Cut}
    \begin{itemize}
        \item Nebenprodukt von Max Flow
        \pause\item DFS/BFS von $s$ ausführen (nur Knoten mit streng positiver restlicher Kapazität
        traversierbar)
        \pause\item Jeder gefundene Knoten ist in $S$
        \pause\item \(T = V\setminus S\)
        \pause\item Alle Kanten in $X_C$ haben Restkapazität $0$ \(\implies\) Min
        Cut $=$ Max Flow
    \end{itemize}
\end{frame}

\begin{frame}{Aufgabe zu Min Cut \& Vertex Capacities}
    \begin{block}{UVa 11506 - Angry Programmer}
        \begin{itemize}
            \item Gefeuerter Programmierer will sich rächen und Netzwerk zerstören
            \pause\item Kann Computer und Kabel (verbinden je einen Computer mit einem
            Anderen) zerstören, jeweils mit bekannten Kosten
            \pause\item Computer des Chefs und Server sind unzerstörbar und Verbindung
soll getrennt werden
            \pause\item Was sind die minimalen Kosten um die Verbindung zu zerstören?
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Aufgabe zu Min Cut \& Vertex Capacities}
    \begin{block}{UVa 11506 - Angry Programmer - Lösung}
        \begin{itemize}
            \pause\item Computer sind Knoten, Kabel sind Kanten
            \pause\item Aufteilen der Knoten mit Gewicht in in- \& out-Knoten mit
            gewichteter Kante
            \pause\item Min Cut
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Aufgabe zu Min Cut \& Vertex Capacities}
    \begin{figure}
        \begin{tikzpicture}[scale=0.7]
            \node[source, visible on=<{1-}>] (Chef) at (0,0) {Chef};
            \node[target, visible on=<{1-}>] (Server) at (9,0) {Server};

            \foreach \pos/\name/\weight in {{(4.5,2)/2/2}, {(4.5,-2)/1/2}}
                \node[card, visible on=<{2}>] (\name) at \pos {$\name\mid\weight$};
            \foreach \source/\dest/\amount in {{Chef/1/3}, {Chef/2/4}, {1/Server/7}, {2/Server/2}}
                \draw [-, thick, visible on=<{2}>] (\source) -- (\dest) node [midway,
                above, sloped] (\source\dest) {$\amount$};

            \foreach \pos/\name in {{(3,2)/2_{in}}, {(6,2)/2_{out}}, {(3,-2)/1_{in}}, {(6,-2)/1_{out}}}
                \node[card, visible on=<{3-}>] (\name) at \pos {$\name$};
            \foreach \source/\dest/\amount in {{Chef/1_{in}/3}, {Chef/2_{in}/4}, {1_{in}/1_{out}/2}, {2_{in}/2_{out}/2}, {1_{out}/Server/7}, {2_{out}/Server/2}}
                \draw [-, thick, visible on=<{3-}>] (\source) -- (\dest) node [midway,
                above, sloped] (\source\dest) {$\amount$};
            \draw[dashed, thick, visible on=<{3}>] plot [smooth] coordinates {(0,2) (2,0)
                (0,-2)};
            \node[visible on=<{3}>] at (0,3) {$7$};
            \draw[thick, dashed, visible on=<{3}>] plot [smooth] coordinates
                {(5,3) (4,-3)};
            \draw[thick, red, dashed, visible on=<{4}>] plot [smooth]
                coordinates {(5,3) (4,-3)};
            \node[visible on=<{3-4}>] at (5,4) {$4$};
            \draw[thick, dashed, visible on=<{3}>] plot [smooth]
                coordinates {(4,3) (3.5,0.5) (2.5,-0.5) (2, -3)};
            \node[visible on=<{3}>] at (2,-4) {$5$};
            \draw[thick, dashed, visible on=<{3}>] plot [smooth] coordinates {(9,2) (7,0) (9,-2)};
            \node[visible on=<{3}>] at (9,3) {$8$};
            \draw[thick, red, dashed, visible on=<{4}>] plot [smooth]
                coordinates {(7,3) (6.5,0.5) (5.5,-0.5) (5,-3)};
            \node[visible on=<{4}>] at (6.5,4) {$4$};
        \end{tikzpicture}
    \end{figure}
\end{frame}

\begin{frame}{Aufgabe zu Min Cut \& Vertex Capacities}
    \begin{figure}
        \begin{tikzpicture}[scale=0.7]
            \node[source, visible on=<{1-}>] (Chef) at (0,0) {Chef};
            \node[target, visible on=<{1-}>] (Server) at (9,0) {Server};
            \node[visible on=<{1}>] (MF) at (12,0) {$mf = 4 = min cut$};
            \foreach \pos/\name in {{(3,2)/2_{in}}, {(6,2)/2_{out}}, {(3,-2)/1_{in}}, {(6,-2)/1_{out}}}
                \node[card, visible on=<{1-}>] (\name) at \pos {$\name$};
            \foreach \source/\dest/\amount in {{Chef/1_{in}/1}, {Chef/2_{in}/2}, {1_{in}/1_{out}/0}, {2_{in}/2_{out}/0}, {1_{out}/Server/5}, {2_{out}/Server/0}}
                \draw [-, thick, visible on=<{1-}>] (\source) -- (\dest) node [midway,
                above, sloped] (\source\dest) {$\amount$};

            \draw[thick, red, dashed, visible on=<{2}>] plot [smooth cycle]
                coordinates {(3.5,4) (3.5,-4) (-2,0)};
            \draw[thick, blue, dashed, visible on=<{2}>] plot [smooth cycle]
                coordinates {(5.5,4) (5.5,-4) (11,0)};
            \begin{pgfonlayer}{bg}
            \foreach \source/\dest/\amount in {{1_{in}/1_{out}/0}, {2_{in}/2_{out}/0}}
                \draw [-, red!50, line width=5pt, visible on=<{3-}>] (\source) -- (\dest);
            \end{pgfonlayer}
        \end{tikzpicture}
    \end{figure}
\end{frame}